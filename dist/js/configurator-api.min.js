window.RoomleConfigurator=function(e,t){Array.isArray||(Array.isArray=function(e){return"[object Array]"===Object.prototype.toString.call(e)});var r={_isLoaded:!1,_isFullscreen:!1,_rapiOnly:!1,_initInProgress:!1,_roomleIframe:null,_baseUrl:"https://www.roomle.com/app/",_iframeCode:'<iframe src="###baseurl###standalone/configurator/[conversationId][options]" style="width: 100%; height: 100%; border: none;"></iframe>',_conversationId:9,_listenerId:0,_elementId:null,_successCallbacks:{},_errorCallbacks:{},_eventListeners:{},_listenerSuccessCallbacks:{},_listenerErrorCallbacks:{},_configurationLoadedListenerErrorCallbacks:{},_configurationLoadedListenerSuccessCallbacks:{},_toggleFullscreen:function(){},_optionsToUrl:function(e){var t="",r="?";for(var n in e)if(e.hasOwnProperty(n)){var i="locale"===n?"overrideLocale":n,o=e[n];if(i&&i.length>1&&"_"===i[0]&&"_"===i[1])continue;if("function"==typeof o)continue;t+=r+i+"="+o,r="&"}return t},_getIframeCode:function(e,t,r,n){n=n||{};var i=this._iframeCode;t!==!1?(i=this._iframeCode.replace(/\[conversationId\]/g,"rapiOnly."+e),this._rapiOnly=t):i=this._iframeCode.replace(/\[conversationId\]/g,e);var o=n.__alternativeUrl?n.__alternativeUrl:this._baseUrl,a=this._optionsToUrl(n),s=a.length>0?"&":"?";return a+=s+"configuratorId="+r,i=i.replace("###baseurl###",o).replace(/\[options\]/g,a),n.sameOrigin&&(i=i.replace(/src=".*(\/app\/.*)"/i,function(e,t){return'src="'+t+'"'})),i.replace('style="width: 100%; height: 100%;"','style="display: none; width: 0; height: 0;"')},_sendToRoomle:function(e){return this._isLoaded===!1?void this._warn("Roomle is not initialized yet! Did you receive an init callback? Did you call init before?"):void this._roomleIframe.postMessage(JSON.stringify(e),"*")},_callSuccessCallback:function(e,t,r,n){return null!==e&&t.length!==e?(this._errorCallbacks[r](t),delete this._errorCallbacks[r]):(this._successCallbacks[r].apply(this._successCallbacks[r],t),n?void 0:delete this._successCallbacks[r])},_callChangeListener:function(e){for(var t in this._listenerSuccessCallbacks)if(this._listenerSuccessCallbacks.hasOwnProperty(t)){var r=this._listenerSuccessCallbacks[t];r.apply(r,e)}},_callConfigurationLoadedListener:function(e){for(var t in this._configurationLoadedListenerSuccessCallbacks)if(this._configurationLoadedListenerSuccessCallbacks.hasOwnProperty(t)){var r=this._configurationLoadedListenerSuccessCallbacks[t];r.apply(r,e)}},_handleResponse:function(e,t,r){if("configurationChanged"===e)return void this._callChangeListener(r);if("configurationLoaded"===e)return void this._callConfigurationLoadedListener(r);if("shareButtonClicked"===e)return void this._callEventListener(e,r);if("printButtonClicked"===e)return void this._callEventListener(e,r);if("number"!=typeof t)return this._throwError('Conversation id is malformed for. Conversation id is "'+t+'" and has type  "'+typeof t+'"');if("function"!=typeof this._successCallbacks[t]){if("initDone"!==e)return this._throwError('No success callback registered with conversationId "'+t+'" for "'+e+'"');this._warn('There is no callback for "initDone" was there a live reload? The scene is blank but you should be able to use the standalone configurator normally.'),this._successCallbacks[t]=this._fallbackSuccessCallback}return"getCurrentConfiguration"===e?2!==r.length?this._throwError("Parameter mismatch! Expected 2 but got "+r.length+" for getCurrentConfiguration"):(r[0]=JSON.parse(r[0]),this._callSuccessCallback(2,r,t)):"getParts"===e?1!==r.length?this._throwError("Parameter mismatch! Expected 1 but got "+r.length+" for getParts"):(r[0]=JSON.parse(r[0]),this._callSuccessCallback(1,r,t)):"function"!=typeof this._errorCallbacks[t]?this._throwError('No error callback registered with conversationId "'+t+'"! This is strange because there should be the fallback error callback'):"setAddToCartListener"===e?this._callSuccessCallback(null,r,t,!0):"setWebshopCallbackUrl"===e?this._callSuccessCallback(null,r,t,!0):"error"===e?1!==r.length?this._throwError('Roomle reported an error but provided no error message for "'+e+'"'):(this._errorCallbacks[t](r[0]),delete this._errorCallbacks[t]):this._callSuccessCallback(null,r,t)},_throwError:function(e){throw new Error("RoomleException: "+e)},_warn:function(e){console&&console.warn&&console.warn(e)},_error:function(e){return new Error(e)},_fallbackErrorCallback:function(e,t){this._throwError("Unhandled error on function "+e+' "'+t+'"! Add an error callback to implement your own error handling')},_fallbackSuccessCallback:function(){},_addSuccessCallback:function(e,t,r){return"function"!=typeof r?this._throwError('There is no success callback for "'+t+'"'):void(this._successCallbacks[e]=r)},_addErrorCallback:function(e,t,r){"function"!=typeof r?this._errorCallbacks[e]=function(e){this._fallbackErrorCallback(t,e)}.bind(this):this._errorCallbacks[e]=r},_nextConversationId:function(){return this._conversationId=this._conversationId+1,this._conversationId},_nextListenerId:function(){return this._listenerId=this._listenerId+1,this._listenerId},_registerListener:function(e,t){var r=this._nextListenerId();return"function"!=typeof t?this._listenerErrorCallbacks[r]=function(e){this._fallbackErrorCallback("listener_with_id_"+r,e)}.bind(this):this._listenerErrorCallbacks[r]=t,this._listenerSuccessCallbacks[r]=e,r},_removeListener:function(e){this._listenerErrorCallbacks[e]&&delete this._listenerErrorCallbacks[e],this._listenerSuccessCallbacks[e]&&delete this._listenerSuccessCallbacks[e]},_registerEventListener:function(e,t){this._eventListeners[e]||(this._eventListeners[e]=[]),this._eventListeners[e].push(t)},_removeEventListener:function(e,t){if(this._eventListeners[e])for(var r=this._eventListeners[e].length,n=0;n<r;n++)this._eventListeners[e][n]===t&&this._eventListeners[e][n].splice(n,1)},_callEventListener:function(e,t){if(this._eventListeners[e])for(var r=this._eventListeners[e].length,n=0;n<r;n++){var i=this._eventListeners[e][n];i.apply(i,t)}},_registerConfigurationLoadedListener:function(e,t){var r=this._nextListenerId();return"function"!=typeof t?this._configurationLoadedListenerErrorCallbacks[r]=function(e){this._fallbackErrorCallback("listener_with_id_"+r,e)}.bind(this):this._configurationLoadedListenerErrorCallbacks[r]=t,this._configurationLoadedListenerSuccessCallbacks[r]=e,r},_removeConfigurationLoadedListener:function(e){this._configurationLoadedListenerErrorCallbacks[e]&&delete this._configurationLoadedListenerErrorCallbacks[e],this._configurationLoadedListenerSuccessCallbacks[e]&&delete this._configurationLoadedListenerSuccessCallbacks[e]},_registerCallbacks:function(e,t,r,n){"number"==typeof n&&n>=10&&this._throwError("Special conversation ID has to be smaller than 10 (<10)");var i="number"==typeof n&&n<10?n:this._nextConversationId();return this._addErrorCallback(i,e,r),this._addSuccessCallback(i,e,t),i},_receiveFromRoomle:function(e){if(e&&e.data){var t=e.data;if("string"==typeof e.data)try{t=JSON.parse(e.data)}catch(e){t=null}if(Array.isArray(t)&&t.length>=2&&t[0].indexOf("MessageFromRoomle")!==-1){var r=t.shift(),n=r.split(".")[1],i=t.shift();return this._handleResponse(n,i,t)}}},_init:function(n,i,o,a,s,l,c,u){if(this._initInProgress===!0)return void this._warn("Init already in progress");var d="string"==typeof o&&"{"!==o[0],f=d?"initConfigurationId":"initConfiguration";f=o?f:"init",o.isTag&&(s._tag=o.tag);var g=this._registerCallbacks(f,c,u),_=t.getElementById(i);this._elementId=i,_.innerHTML=this._getIframeCode(g,l,n,s);var h=_.firstElementChild;h||h.contentWindow?(r._roomleIframe=h.contentWindow,e.addEventListener("message",this._receiveFromRoomle.bind(this),!1)):this._throwError("Problem finding roomle iframe"),this._initInProgress=!0},_finishedInit:function(){this._isLoaded=!0,this._initInProgress=!1},_isAvailable:function(e,t){return this._rapiOnly!==!0||!t||(this._warn(e+" needs webgl"),!1)}},n={__successCallbacks:r._successCallbacks,__errorCallbacks:r._errorCallbacks,init:function(e,t,n,i,o,a){var s=!1,l=this;null===i&&(i={}),r._init(e,t,n,o,i,s,function(){if(r._finishedInit(),l.setContainerId(e),i&&i.enablePrint===!0&&r._registerEventListener("printButtonClicked",function(){var e={dimensions:i.dimensionsFormatter||null,price:i.priceFormatter||null};l.openPrint(null,e)}),"function"==typeof o?o():o=function(){},n&&!n.isTag){if(n.isItem)return void l.loadItem(n.id);var t="string"==typeof n&&"{"!==n[0];t?l.loadConfigurationId(n):l.loadConfiguration(n)}},function(e){a(e)})},initWithoutWebGl:function(e,t,n,i,o){var a=!0;n=n||{},r._init(e,t,{},i,n,a,function(){r._finishedInit(),"function"==typeof i&&i()},function(e){"function"==typeof o?o(e):r._throwError(e)})},loadConfiguration:function(e,t,n){if(r._isAvailable("loadConfiguration",!0)){"string"!=typeof e&&(e=JSON.stringify(e));var i="loadConfiguration";t=t||r._fallbackSuccessCallback;var o=r._registerCallbacks(i,t,n);r._sendToRoomle(["loadConfiguration",o,e])}},loadComponent:function(e,t,n){if(r._isAvailable("loadComponent",!0)){"string"!=typeof e&&(e=JSON.stringify(e));var i="loadComponent";t=t||r._fallbackSuccessCallback;var o=r._registerCallbacks(i,t,n);r._sendToRoomle(["loadComponent",o,e])}},loadConfigurationId:function(e,t,n){if(r._isAvailable("loadConfigurationId",!0)){var i="loadConfigurationId";t=t||r._fallbackSuccessCallback;var o=r._registerCallbacks(i,t,n),a=!0;r._sendToRoomle(["loadConfigurationId",o,e,a])}},loadItem:function(e,t,n){if(r._isAvailable("loadItem",!0)){var i="loadItem";t=t||r._fallbackSuccessCallback;var o=r._registerCallbacks(i,t,n);r._sendToRoomle(["loadItem",o,e])}},loadTag:function(e,t,n){if(r._isAvailable("loadTag",!0)){var i="loadTag";t=t||r._fallbackSuccessCallback;var o=r._registerCallbacks(i,t,n);r._sendToRoomle(["loadTag",o,e])}},setContainerId:function(e,t,n){if(r._isAvailable("loadConfigurationId",!0)){var i="setContainerId";t=t||r._fallbackSuccessCallback;var o=r._registerCallbacks(i,t,n);r._sendToRoomle(["setContainerId",o,e])}},getCurrentParts:function(e,t){var n="getCurrentParts";if(!r._isAvailable(n,!0))return t(r._error(n+" is not available without webgl"));var i=r._registerCallbacks(n,e,t);r._sendToRoomle(["getCurrentParts",i])},setAddToCartListener:function(e,t,n){var i="setAddToCartListener";if(!r._isAvailable(i,!0))return n(r._error(i+" is not available without webgl"));var o=r._registerCallbacks(i,t,n);r._sendToRoomle(["setAddToCartListener",o,e])},setFullscreenListener:function(e){var t=document.getElementById(r._elementId),n="getRoomleConfig",i=r._registerCallbacks(n,function(n){var i=".roomle-configurator--fullscreen svg {position: absolute;left: 5px;top: 5px;height: 30px;width: 30px;cursor: pointer;} .roomle-configurator--fullscreen svg:hover { fill:"+n.configurator_font_color_highlighted+"; }",o=document.head||document.getElementsByTagName("head")[0],a=document.createElement("style");a.type="text/css",a.styleSheet?a.styleSheet.cssText=i:a.appendChild(document.createTextNode(i)),o.appendChild(a),t.style.position="relative";var s=document.createElement("div");s.setAttribute("class","roomle-configurator--fullscreen");var l=document.createElementNS("http://www.w3.org/2000/svg","svg");l.setAttributeNS(null,"version","1.1"),l.setAttributeNS(null,"x","0px"),l.setAttributeNS(null,"y","0px"),l.setAttributeNS(null,"viewBox","-247 370.9 100 100"),l.setAttributeNS(null,"enable-background","new -247 370.9 100 100");var c=document.createElementNS("http://www.w3.org/2000/svg","g"),u=document.createElementNS("http://www.w3.org/2000/svg","path");u.setAttributeNS(null,"d","M-160.7,386.7v19.3c0,1.2-1,2.2-2.2,2.2c-1.2,0-2.2-1-2.2-2.2v-14l-23.8,23.8c-0.4,0.4-1,0.6-1.5,0.6s-1.1-0.2-1.6-0.6 c-0.9-0.9-0.9-2.2,0-3.1l23.8-23.8h-14c-1.2,0-2.2-1-2.2-2.2c0-1.2,1-2.2,2.2-2.2h19.3c0.2,0,0.4,0,0.7,0.1c0.1,0,0.1,0.1,0.2,0.1 c0.3,0.1,0.5,0.3,0.7,0.5c0.1,0.1,0.1,0.1,0.1,0.2c0.1,0.1,0.2,0.2,0.2,0.4c0,0.1,0.1,0.1,0.1,0.2c0.1,0.2,0.1,0.4,0.1,0.6 c0,0,0,0,0,0.1C-160.7,386.6-160.7,386.7-160.7,386.7z");var d=document.createElementNS("http://www.w3.org/2000/svg","g"),f=document.createElementNS("http://www.w3.org/2000/svg","path");f.setAttributeNS(null,"d","M-162.9,457.2h-68.3c-1.2,0-2.2-1-2.2-2.2v-68.3c0-1.2,1-2.2,2.2-2.2h19.3c1.2,0,2.2,1,2.2,2.2s-1,2.2-2.2,2.2h-17.1v63.9 h63.9v-17.1c0-1.2,1-2.2,2.2-2.2c1.2,0,2.2,1,2.2,2.2V455C-160.7,456.2-161.7,457.2-162.9,457.2z"),c.appendChild(u),d.appendChild(f);var g=document.createElementNS("http://www.w3.org/2000/svg","g"),_=document.createElementNS("http://www.w3.org/2000/svg","path");_.setAttributeNS(null,"d","M-192.6,413.2v-19.3c0-1.2,1-2.2,2.2-2.2c1.2,0,2.2,1,2.2,2.2v14l23.8-23.8c0.4-0.4,1-0.6,1.5-0.6s1.1,0.2,1.5,0.6 c0.9,0.9,0.9,2.3,0,3.1l-23.8,23.8h14c1.2,0,2.2,1,2.2,2.2c0,1.2-1,2.2-2.2,2.2h-19.3c-0.2,0-0.5,0-0.6-0.1c-0.1,0-0.2-0.1-0.2-0.1 c-0.2-0.1-0.5-0.2-0.7-0.5c-0.1-0.1-0.1-0.1-0.2-0.2s-0.2-0.2-0.2-0.4c0-0.1-0.1-0.2-0.1-0.2c-0.1-0.2-0.2-0.4-0.2-0.6v-0.1 C-192.6,413.3-192.6,413.2-192.6,413.2z"),g.appendChild(_),l.appendChild(c),l.appendChild(d);var h=!1,C=function(){h=!0,r._isFullscreen?(l.removeChild(g),l.appendChild(c)):(l.removeChild(c),l.appendChild(g)),r._isFullscreen=!r._isFullscreen,e.apply(e,[])};s.addEventListener("click",C);var b=function(){h||C(),h=!1};r._toggleFullscreen=C,document.addEventListener("webkitfullscreenchange",b,!1),document.addEventListener("mozfullscreenchange",b,!1),document.addEventListener("fullscreenchange",b,!1),s.appendChild(l),t.insertBefore(s,t.firstChild)});r._sendToRoomle(["getRoomleConfig",i])},getParts:function(e,t,n){var i="getParts",o=r._registerCallbacks(i,t,n);r._sendToRoomle(["getParts",o,e])},getPrice:function(e,t,n){var i="getPrice",o=r._registerCallbacks(i,t,n);r._sendToRoomle(["getPrice",o,e])},getPerspectiveImage:function(e,t,n){var i="getPerspectiveImage",o=r._registerCallbacks(i,t,n);r._sendToRoomle(["getPerspectiveImage",o,e])},getTopImage:function(e,t,n){var i="getTopImage",o=r._registerCallbacks(i,t,n);r._sendToRoomle(["getTopImage",o,e])},getCurrentPrice:function(e,t){var n="getCurrentPrice";if(!r._isAvailable(n,!0))return t(r._error(n+" is not available without webgl"));var i=r._registerCallbacks(n,e,t);r._sendToRoomle(["getCurrentPrice",i])},addToCart:function(e,t){var n="addToCart";if(!r._isAvailable(n,!0))return t(r._error(n+" is not available without webgl"));var i=r._registerCallbacks(n,e,t);r._sendToRoomle(["addToCart",i])},generateBase64ImagesOfCurrentConfiguration:function(e,t,n){n=n||{},n.pixelPerMeter=n.pixelPerMeter||200,n.perspectiveImageSize=n.perspectiveImageSize||320;var i="generateBase64ImagesOfCurrentConfiguration";if(!r._isAvailable(i,!0))return t(r._error(i+" is not available without webgl"));var o=r._registerCallbacks(i,e,t);r._sendToRoomle(["generateBase64ImagesOfCurrentConfiguration",o,n])},generateImagesOfCurrentConfiguration:function(e,t){var n="generateImagesOfCurrentConfiguration";if(!r._isAvailable(n,!0))return t(r._error(n+" is not available without webgl"));var i=r._registerCallbacks(n,e,t);r._sendToRoomle(["generateImagesOfCurrentConfiguration",i,200])},getCurrentConfiguration:function(e,t){var n="getCurrentConfiguration";if(!r._isAvailable(n,!0))return t(r._error(n+" is not available without webgl"));var i=r._registerCallbacks(n,e,t);r._sendToRoomle(["getCurrentConfiguration",i])},getObjectData:function(e,t,n){var i="getObjectData";if(!r._isAvailable(i,!1))return n(r._error(i+" is not available without webgl"));var o=r._registerCallbacks(i,t,n);r._sendToRoomle(["getObjectData",o,e])},toggleFullscreen:function(){r._toggleFullscreen()},getCurrentConfigurationId:function(e,t){var n="getCurrentConfigurationId";if(!r._isAvailable(n,!0))return t(r._error(n+" is not available without webgl"));var i=r._registerCallbacks(n,e,t);r._sendToRoomle(["getCurrentConfigurationId",i])},setWebshopCallbackUrl:function(e){var t="setWebshopCallbackUrl",n=r._registerCallbacks(t,function(e,t,r){setTimeout(function(){window.location=t},r),window.location=e});r._sendToRoomle([t,n,e])},setShareButtonClickedCallback:function(e){r._registerEventListener("shareButtonClicked",e),r._sendToRoomle(["useCustomShareLink",null,!0])},setShareLink:function(e){r._sendToRoomle(["setShareLink",1,e])},openPrint:function(e,t){e=e||2e3,t=t||{},t.dimensions=t.dimensions||function(e){var t=function(e){return(e/10).toFixed(2)};return t(e.x)+" / "+t(e.y)+" / "+t(e.z)+" cm"},t.price=t.price||function(e,t){return e+" "+t};var r=this;this.getCurrentPrice(function(n,i){r.getCurrentDimensions(function(o){r.generateBase64ImagesOfCurrentConfiguration(function(e,r){var a=document.createElement("style"),s=document.createElement("div"),l=document.createElement("img"),c=document.createElement("h3"),u=document.createElement("h3");c.innerText=t.price(i,n),u.innerText=t.dimensions(o),l.setAttribute("class","__roomle-print-img"),l.setAttribute("src","data:image/png;base64,"+r),a.innerText="*{display: none;}html, body{display:block}.__roomle-print-container{margin-left:5%;margin-top:2%;position:absolute; z-index: 99999; width: 90%; height: 80%; background-color: white; text-align:center;display:block;}.__roomle-print-img{height:100%;display:inline-block}h3{display:block;height:5%;overflow:hidden;}",s.setAttribute("class","__roomle-print-container"),s.appendChild(l),s.appendChild(c),s.appendChild(u),document.body.prepend(s),document.head.prepend(a),window.print(),setTimeout(function(){document.body.removeChild(s),document.head.removeChild(a)},0)},null,{perspectiveImageSize:e})})})},getCurrentDimensions:function(e,t){var n="getCurrentDimensions";if(!r._isAvailable(n,!0))return t(r._error(n+" is not available without webgl"));var i=r._registerCallbacks(n,e,t);r._sendToRoomle(["getCurrentDimensions",i])},saveCurrentConfiguration:function(e,t){var n="saveCurrentConfiguration";if(!r._isAvailable(n,!0))return t(r._error(n+" is not available without webgl"));var i=r._registerCallbacks(n,e,t);r._sendToRoomle(["saveCurrentConfiguration",i])},didCheckout:function(e,t,n){var i="didCheckout";if(!r._isAvailable(i,!0))return n(r._error(i+" is not available without webgl"));var o=r._registerCallbacks(i,t,n);r._sendToRoomle(["didCheckout",o,e])},addChangeListener:function(e){var t=r._registerListener(e,function(){r._throwError("Some strange error on addChangeListener")});return t},removeChangeListener:function(e){r._removeListener(e)},addConfigurationLoadedListener:function(e){var t=r._registerConfigurationLoadedListener(e,function(){r._throwError("Some strange error on addConfigurationLoadedListener")});return t},removeConfigurationLoadedListener:function(e){r._removeConfigurationLoadedListener(e)}};return n}(window,document);
//# sourceMappingURL=map/configurator-api.min.js.map
